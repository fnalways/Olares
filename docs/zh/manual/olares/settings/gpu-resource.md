---
outline: [2, 3]
description: 控制管理和优化 Olares显卡资源，支持单节点或多节点环境下的时间分片、独占和显存分片分配模式。
---

# 管理 GPU 使用

:::info
只有 Olares 管理员可以配置 GPU 使用模式。这样可以确保系统范围内的资源得到最优化管理，避免用户之间的资源冲突。
:::

Olares 让你充分发挥 GPU 的算力，加速大模型推理、图像/视频生成及游戏等高负载任务。无论 GPU 位于单个节点还是多个节点，都可在同一界面集中管理。

本文档帮你了解并配置 GPU 分配模式，发挥硬件最大效能。

## 多 GPU 和节点的关系

在配置 GPU 之前，需要先理解 Olares 在多节点场景下，如何为应用分配和绑定 GPU。

- **同一节点**：如果多个 GPU 位于同一个物理节点上，你可以将它们同时分配给同一个应用（多卡并行）。
- **跨节点**：如果多个 GPU 分布在不同节点上，同一个应用**不能同时**绑定到这些 GPU 上。


:::warning 配置失败
如果尝试将位于不同节点的 GPU 绑定到同一个应用，配置会失败。

在分配 GPU 之前，请务必在 **设置** > **GPU** 列表中确认每个 GPU 所在节点。
:::

:::tip 切换与绑定
- 当您在**同一节点**内将应用从一个 GPU **切换**到另一个 GPU 时，该应用最终可能会同时绑定到两个 GPU 上（单节点多卡模式）。
- 当你将应用**切换**到属于另一节点的 GPU 时，该应用会被移动，最终仅绑定到目标 GPU（不支持跨节点多卡模式）。
:::

## GPU 兼容性

Olares 仅支持 **Nvidia Turing 架构及之后**的显卡（Turing, Ampere, Ada Lovelace, 和 Blackwell）。

- **快速检查**：支持 GTX/RTX **16 系列及更新**的消费级显卡。
- **其他型号**：请对照[NVIDIA 官方兼容列表](https://github.com/NVIDIA/open-gpu-kernel-modules?tab=readme-ov-file#compatible-gpus)。
- **未知型号**：运行`lspci | grep -i nvidia`查询 GPU 架构代码以确定兼容性。

:::warning AI 性能
即使架构受支持，如果**显存容量过小**，也可能导致 AI 应用无法运行或频繁报错。请确保 GPU 的显存容量足以支撑你的实际工作负载。
:::

## 理解 GPU 分配模式

Olares 当前支持三种 GPU 分配模式。根据你的负载特性选择合适的模式，更好地利用 GPU 资源。

### 时间分片

在时间分片模式下，一个 GPU 可以同时绑定给多个应用，并通过时间切片轮流执行任务。

- **共享访问**：任意时刻，只有一个应用占用该 GPU 的全部算力和显存。
- **自动调度**：没有明确分配 GPU 资源的应用，会自动加入时间分片队列。
- **排队等待**：其他应用会进入等待队列，其显存内容（如 CUDA 上下文等）可能被暂时换出到系统内存。

:::info 默认 GPU 分配模式
默认情况下，GPU 运行在 **时间分片** 模式。  
未显式分配 GPU 资源的应用将自动调度到处于时间分片模式的 GPU 上，并自动进行绑定。
未显式分配 GPU 资源的应用，会自动调度到处于时间分片模式的 GPU 上，并自动与该 GPU 绑定。
:::

### 应用独占

在应用独占模式下，一个 GPU 只分配给一个应用。

- **独占资源**：绑定的应用可独占该 GPU 的全部算力和显存。
- **性能最佳**：没有跨应用争用和调度开销，适合需要稳定高性能的大模型推理、渲染等负载。

### 显存分片

在显存分片模式下，一个 GPU 的显存会被划分成多个固定配额，分配给多个指定应用。

- **固定配额**：你可以为每个应用手动设置一个显存上限（单位：GB）。
- **并发运行**：多个应用可以并行运行，但各自受限于自己的显存配额。
- **总量限制**：所有应用的显存配额之和不能超过该 GPU 的物理显存总量（不支持超分配/超卖）。


:::tip 多 GPU 分配
在**同一节点**上，三种模式都支持为同一个应用分配多个 GPU。Olares 只负责将这些 GPU 挂载到应用容器中，并不会自动做显存或算力的“融合”。应用是否真正使用多卡，由其自身框架决定。
:::

## 查看 GPU 状态

查看当前 GPU 状态：

1. 打开**设置** > **GPU**。列表会显示每个 GPU 的型号、所属节点、总显存和当前模式。
2. 点击任意一个 GPU，可以进入该 GPU 的详情页。
![GPU 概览](/images/zh/manual/olares/gpu-overview.png#bordered)

::: tip Note
如果你的 Olares 只有一个 GPU，进入 GPU 页面时会直接跳转到该 GPU 的详情页。
:::

## 配置 GPU 模式

在 GPU 详情页中，可以通过 **GPU 模式**下拉菜单选择该 GPU 的分配模式。

### 时间分片

 ![时间分片](/images/zh/manual/olares/gpu-time-slicing.png#bordered)

1. 从下拉菜单选择**时间分片**。
2. 在绑定应用区域，你可以绑定应用并管理已有的绑定关系：
   - **绑定应用**：  
     点击**绑定应用**，将某个应用手动绑定到当前 GPU，并以时间分片模式运行。  
     即使你不手动绑定，由于时间分片是默认模式，调度器也可以自动将应用分配到该 GPU 上。

   - **切换 GPU**：
     点击应用右侧的 <i class="material-symbols-outlined">repeat</i> 图标，可以将该应用“切换”到另一个 GPU。具体行为取决于目标 GPU 所在的节点：

     - **目标在同一节点**：
       应用容器会重启，重启后，该应用会同时绑定在原 GPU 和目标 GPU 上（同节点多卡）。

     - **目标在其他节点**： 
       应用容器会重启，重启后，该应用会被迁移到目标 GPU 上，只与目标 GPU 绑定，不再出现在原 GPU 下。

   - **解绑应用**  ：
     点击 <i class="material-symbols-outlined">link_off</i>，将应用从当前 GPU 解绑。

     - 由于时间分片是默认模式，当一个应用不再绑定任何 GPU 时，调度器可能会再次把它自动调度到任意一块处于时间分片模式的 GPU 上，并自动完成绑定（包括当前这块 GPU 在内）。

### 应用独占
![独占](/images/zh/manual/olares/gpu-app-exclusive.png#bordered)

1. 从下拉菜单中选择**应用独占**。
2. 在选取独占应用区域，点击**绑定应用**来选择目标应用，然后点击**确认**。  
   应用会绑定到当前 GPU，并以独占模式运行。
3. 绑定完成后，你可以在选取独占应用区域区域执行以下操作：

   - **切换应用**：  
     点击**切换应用**，将当前独占应用替换为另一个应用。原应用会从该 GPU 上解绑，新应用成为新的独占应用。

   - **切换 GPU**：
     点击 <i class="material-symbols-outlined">repeat</i>，将当前独占绑定迁移到同一节点上的另一个 GPU。

   - **解绑（Unbind）：**  
     点击 <i class="material-symbols-outlined">link_off</i>，将应用从该 GPU 上解绑，释放这块 GPU。

### 显存分片
![显存分片](/images/zh/manual/olares/gpu-memory-slicing.png#bordered)
1. 从下拉菜单选择**显存分片**。
2. 在分配显存区域，点击**绑定应用**。
3. 选择目标应用，为其分配一个显存配额（单位 GB），然后点击**确认**。
4. 如有需要，可以再次点击**绑定应用**，为其他应用分配显存配额。  
   请确保所有配额之和不超过该 GPU 的物理显存总量。

:::info 模式切换
更改 GPU 的模式（例如从时间分片模式切换到应用独占模式）将解绑该 GPU 上的所有应用并重启其容器。

重启后，应用将遵循正常的调度规则，即如果系统中有任何运行在时间分片模式下的 GPU，未绑定的应用可能会被自动调度并绑定到该 GPU 上。
:::

## 了解更多
- [监控 Olares 中的显卡使用情况](../resources-usage.md)